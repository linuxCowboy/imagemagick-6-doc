<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.6.0">
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../../../html/www/css/magick.css">
  <title>Fourier Multiply/Divide -- IM v6 Examples</title>
  <link rel="icon" href="../../img_www/favicon.ico" type=
  "image/x-icon">
  <link rel="shortcut icon" href="../../img_www/favicon.ico" type=
  "image/x-icon">
  <link rel="canonical" href=
  "https://legacy.imagemagick.org/Usage/fourier/fft_math/">
  <!--[if gte IE 5.5000]><![if lt IE 7.0000]>
<script type="text/javascript" src="../../img_www/pngfix.js"></script>
<![endif]><![endif]-->
</head>
<body bgcolor="#B0C4DE">
  <h1>ImageMagick v6 Examples --<br>
  <img src="../../img_www/space.gif" width="50" height="1"> Fourier
  Multiply/Divide</h1>
  <div align="justify">
    <dl>
      <dt><b>Index</b></dt>
      <dt>
        <a href="../../index.html"><img src=
        "../../img_www/granitesm_left.gif" border="0" width="15"
        height="15">ImageMagick Examples Preface and Index</a>
      </dt>
      <dt>
        <a href="../index.html"><img src=
        "../../img_www/granitesm_left.gif" border="0" width="15"
        height="15">Fourier Transforms</a>
      </dt>
      <dd>
        <a href="index.html#intro"><img src=
        "../../img_www/granitesm_right.gif" border="0" width="15"
        height="15">DIY FFT Mathematics Introduction</a>
      </dd>
      <dd>
        <a href="index.html#multiply"><img src=
        "../../img_www/granitesm_right.gif" border="0" width="15"
        height="15">FFT Multiply</a>
        <ul>
          <li>
            <a href="index.html#multiply_mp">Magnitude/Phase
            Images, Using IM Q16 non-HDRI</a>
          </li>
          <li>
            <a href="index.html#multiply_ri">Real/Imaginary Images,
            Using IM Q16 HDRI</a>
          </li>
        </ul>
      </dd>
      <dd>
        <a href="index.html#divide"><img src=
        "../../img_www/granitesm_right.gif" border="0" width="15"
        height="15">FFT Division</a>
        <ul>
          <li>
            <a href="index.html#divide_mp">Magnitude/Phase Images,
            Using IM Q16 non-HDRI</a>
          </li>
          <li>
            <a href="index.html#divide_ri">Real/Imaginary Images,
            Using IM Q16 HDRI</a>
          </li>
        </ul>
      </dd>
    </dl>
    <hr>
    <!-- ---------------------------------------------------------------- -->
    <a name="intro" id="intro"></a>
    <h2>DIY FFT Mathematics Introduction</h2>Below are examples of
    a number of techniques for doing multiplication and Division
    with the two different styles of Fast Fourier Transform images.
    Their are basically two ways of doing the mathematics. Using FX
    math, and using Composite Maths....
    <dl>
      <dt><b>FX Math</b></dt>
      <dd>
        Using <a href=
        "http://legacy.imagemagick.org/Usage/transforms/#fx">FX,
        DIY Operator</a> applies the formula directly. But as it is
        interpreted, it is very slow. However the formulas are
        applied all in a single expression, avoiding the need for
        intermedite images. For non-HDRI versions of IM this will
        reduce Quantum Rounding effects.
      </dd>
      <dt><b>Composite math</b></dt>
      <dd>This uses Image Composition to perform mathematical
      operations, which is much faster than 'FX Math'. However you
      can only do one mathematical operation at a time, which means
      after every operation the image must be saved into another
      in-memory image. For non-HDRI versions this will produce
      extra 'rounding effects' between operations.</dd>
    </dl>The other aspect touched on above is the use of HDRI.
    <a href="../../basics/index.html#hdri">HDRI versions of
    ImageMagick</a> saves the color values as floating point
    numbers instead of QuantumRange scaled integers (See <a href=
    "../../basics/index.html#quality">Quality</a>). As such when
    generating the FFT images, or saving the intermedite results to
    a new image, does not cause 'rounding effects' especially when
    small values (typical in FFT images) are involved. Also as
    Real/Imaginary FFT image pairs require the use of negative
    numbers you must use a HDRI version of image magick when
    processing these types of FFT images. Negatives are however not
    a problem for Magnitude/Phase FFT images, so you can process
    such images without using HDRI, though you will still have
    strong 'rounding effects' between each and every image
    processing step. Because of this Fast Fourier transforms, are
    best used on <a href="../../basics/index.html#hdri">HDRI</a>
    versions of ImageMagick, regardless of the type of FFT images
    you are using. The exact same commands are used for both HDRI
    and non-HDRI version of ImageMagick.
    <table border="0" cellspacing="0" cellpadding="0" width="90%"
    align="center">
      <tr valign="top">
        <td><img src="../../img_www/reminder.gif" width="20"
        height="16"><img src="../../img_www/space.gif" width="20"
        height="16"></td>
        <td align="justify" width="100%"><font size="-1"><i>When
        saving intermediate <a href=
        "../../basics/index.html#hdri">HDRI</a> images to a disk
        file, you will need to use one of the very few floating
        point image file formats. These formats include <a href=
        "../../formats/index.html#netpbm">NetPBM PFM</a> file
        format, <a href="../../formats/index.html#tiff">TIFF</a>,
        or the <a href="../../files/index.html#miff">MIFF</a> file
        format with the special setting "<code>-define
        quantum:format=floating-point</code>".<br>
        <br></i></font></td>
      </tr>
    </table><br>
    Here is the convolution kernel image we will be using...
    <table border="0" cellspacing="0" cellpadding="0" width="100%"
    align="center">
      <tr>
        <td width="100%" align="justify">
          <table border="1" cellspacing="0" cellpadding="5" width=
          "100%" bgcolor="#CCCCCC">
            <tr>
              <td>
                <pre><code execute="">
  # motion blur kernel
  #convert -size 128x128 xc:black -fill white -draw 'line 60,64 68,64' \
  #        -alpha off convolve_kernel.png

  # disk blur kernel (Fred Wienhaus's version)
  convert -size 128x128 xc:black -fill white -draw 'circle 64,64 54,64' \
          -alpha off convolve_kernel.png

</code></pre>
              </td>
            </tr>
          </table>
        </td>
        <td align="center">
          <a href="convolve_kernel.png"><img src=
          "convolve_kernel.png" width="128" height="128" align=
          "middle" vspace="0" hspace="5" border="1" alt=
          "[IM Output]"></a>
        </td>
      </tr>
    </table>The convolution kernel must be rolled so that pixel 0,0
    contains the center of convolution. In this case a "<code>-roll
    -64-64</code>" needs to be applied immediately the kernel image
    is read in. The kernel image also needs to be divided by its
    mean so as to preserve the intensity of the image it is being
    FFT multiplied or divided against. This is a major complication
    with FFT multiplication and division. As non-HDRI images can
    not be normalized in this way this is generally done after the
    FFT conversion has been applied, and before multiplication. For
    HDRI version of IM you can do this at any time.
    <hr>
    <!-- ---------------------------------------------------------------- -->
    <a name="multiply" id="multiply"></a>
    <h2>FFT Multiplication &nbsp; <font size="5">( <img src=
    "../../img_www/fft_multiply.gif" align="absmiddle">
    )</font></h2><a name="multiply_mp" id="multiply_mp"></a>
    <h3>FFT multiply of Magnitude/Phase Images, Using IM Q16</h3>
    <pre>
    R = A <font size="+2">⊗</font> B       ( FFT Multiply )

    Rm = Am × Bm
    Rp = mod( Ap + Bp +0.5, 1.0)

    mean = the DC value (center pixel) of the magnitude image
</pre>Using FX Math,<br>
    (note value v.p{64x64} is the DC, or mean of the convolve
    kernel)
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="">
  # non-HDRI
  convert convolve_kernel.png -roll -64-64 -fft \
          \( cameraman_sm.png -fft \) \
          \
          \( -clone 0,2 -fx 'u*v / p{64,64} ' \) \
          \( -clone 1,3 -fx 'mod(u + v + 0.5, 1.0)' \) \
          \
          -delete 0-3 -ift  cameraman_convolve_1.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_1.png"><img src=
      "cameraman_convolve_1.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Using Composite Maths...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="">
  # non-HDRI
  convert convolve_kernel.png -roll -64-64 -fft \
          \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \
             -clone 0 -compose divide -composite \) -swap 0 +delete \
          \( cameraman_sm.png -fft \) \
          \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose add -background gray50 -flatten \) \
           -delete 0-3 -ift  cameraman_convolve_2.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_2.png"><img src=
      "cameraman_convolve_2.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Note that "add" is a modulo addition composition, which
    works to add values the 50% biased values, to generate a 50%
    biased value. Alternative<br>
    Divide with mean from original image
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="">
  # non-HDRI
  convert convolve_kernel.png \( -clone 0 -roll -64-64 -fft \) \
          \( -clone 0 -scale 1x1 -scale 128x128 \
             -clone 1 -compose divide -composite \) \
          -delete 0,1 +swap \
          \( cameraman_sm.png -fft \) \
          \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose add -background gray50 -flatten \) \
           -delete 0-3 -ift  cameraman_convolve_2b.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_2b.png"><img src=
      "cameraman_convolve_2b.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Alternative...<br>
    Note that the DC value divided by DC value ==&gt; 1.0 As DC
    value is the largest value in a magnitude spectrum, why not
    just normalise! EG: <code>-auto-level</code>" This can only be
    done to a magnitude image, and will not work with
    real/imaginary pairs as they have to be stretched by the same
    amount.
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="">
  # non-HDRI
  convert convolve_kernel.png -roll -64-64 -fft \
          \( -clone 0 -auto-level \) -swap 0 +delete \
          \( cameraman_sm.png -fft \) \
          \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose add -background gray50 -flatten \) \
          \
          -delete 0-3 -ift  cameraman_convolve_2c.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_2c.png"><img src=
      "cameraman_convolve_2c.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div><a name="multiply_ri" id="multiply_ri"></a>
    <h3>FFT multiply of Real/Imaginary Images, Using IM HDRI</h3>
    <pre>
    R = A <font size="+2">⊗</font> B       ( FFT Multiply )

    Rr = Ar×Br - Ai×Bi
    Ri = Ar×Bi + Ai×Br

    mean = the DC value (center pixel) of the real image
</pre>Using FX...<br>
    5 images involved, the 5'th being scaled mean - FX does the
    division
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 \( +clone +fft \) \
          \( cameraman_sm.png +fft \) +matte \
          \( -clone 0 -scale 1x1 \) -delete 0 \
          \
          \( -clone 0-4 -fx '( u[0]*u[2] - u[1]*u[3] ) / u[4].p{0,0}' \) \
          \( -clone 0-4 -fx '( u[0]*u[3] + u[1]*u[2] ) / u[4].p{0,0}' \) \
          -delete 0-4 +ift  cameraman_convolve_3.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_3.png"><img src=
      "cameraman_convolve_3.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Using FX...<br>
    using the DC value for the mean (no 5'th image)
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 +fft \
          \( cameraman_sm.png +fft \) \
          \
          \( -clone 0-3 -fx '( u[0]*u[2] - u[1]*u[3] ) / u[0].p{64,64}' \) \
          \( -clone 0-3 -fx '( u[0]*u[3] + u[1]*u[2] ) / u[0].p{64,64}' \) \
          -delete 0-3 +ift  cameraman_convolve_3b.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_3b.png"><img src=
      "cameraman_convolve_3b.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Using Composite Maths...<br>
    With the scale image mean!
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 \
          \( -clone 0 -scale 1x1 -scale 128x128 \) \
          \( -clone 0 +fft \) \
          \( -clone 1,2 -compose divide -composite \) \
          \( -clone 1,3 -compose divide -composite \) \
          -delete 0--3 \
          \
          \( cameraman_sm.png  +fft \) \
          \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose multiply -composite \) \
          \( -clone 0,3 -compose multiply -composite \) \
          \( -clone 1,2 -compose multiply -composite \) \
          \
          \( -clone 4,5 +swap +matte -compose minus -composite \) \
          \( -clone 6,7 -compose plus -composite \) \
          \
          -delete 0--3 +ift  cameraman_convolve_4.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_4.png"><img src=
      "cameraman_convolve_4.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Optimized Composite Maths...<br>
    Mean from image scaling
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 \
          \( -clone 0 -scale 1x1 -scale 128x128 \) \
          \( -clone 0 +fft    null: +insert    -clone 1 +insert \
             -compose divide -layers composite \) -delete 0,1  \
          \
          \( cameraman_sm.png +fft \) \
          \
          \( -clone 0,1,0,1 null: -clone 2,3,3,2 \
                -compose multiply -layers composite \) \
          \( -clone 4,5 +swap +matte -compose minus -composite \) \
          \( -clone 6,7 -compose plus -composite \) \
          \
          -delete 0--3 +ift  cameraman_convolve_4b.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_4b.png"><img src=
      "cameraman_convolve_4b.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Alternative...<br>
    Use the DC value for mean...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 +fft \
          \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \) \
          null: +insert +insert   -compose divide -layers composite \
          \
          \( cameraman_sm.png +fft \) \
          \
          \( -clone 0,1,0,1 null: -clone 2,3,3,2 \
                -compose multiply -layers composite \) \
          \( -clone 4,5 +swap +matte -compose minus -composite \) \
          \( -clone 6,7 -compose plus -composite \) \
          \
          -delete 0--3 +ift  cameraman_convolve_4c.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_convolve_4c.png"><img src=
      "cameraman_convolve_4c.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>Alturnative...<br>
    Apply DC value mean, AFTER the FFT multiply...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="">
  # HDRI
  convert convolve_kernel.png -roll -64-64 +fft \
          \( cameraman_sm.png  +fft \) \
          \
          \( -clone 0,1,0,1 null: -clone 2,3,3,2 \
                -compose multiply -layers composite \) \
          \( -clone 4,5 +swap -compose minus -composite \) \
          \( -clone 6,7 -compose plus -composite \) \
          \
          \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \
             null: -clone -2,-1  -compose divide -layers composite \) \
          \
          -delete 0--3 +ift  cameraman_convolve_4d.png
</code></pre>
          </td>
        </tr>
      </table><a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_multiply.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "http://legacy.imagemagick.org/Usage/fourier/fft_math/cameraman_deconvolve_4d.png">
      <img src="cameraman_convolve_4d.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <hr>
    <a name="divide" id="divide"></a>
    <h2>FFT Division &nbsp; <font size="5">( <img src=
    "../../img_www/fft_divide.gif" align="absmiddle">
    )</font></h2>Here use use division to remove or de-convolve
    (for want of a better word) the blur that was added to the
    above image. It is basically exactly the same except that the
    'normalized' convolution kernel is divided from the main image.
    Each Example uses the image generated, using the same technique
    as above. <a name="divide_mp" id="divide_mp"></a>
    <h3>FFT divide of Magnitude/Phase, Using IM Q16</h3>
    <pre>
    R = B <font size="+2">ø</font> A       ( FFT Divide )

    Rm = Bm / Am
    Rp = mod( -Ap + Bp +1.5, 1.0)

    mean = the DC value (center pixel) of the magnitude image
</pre>NOTE: A minimum of QuantumScale is added to the denominator
to avoid perfect division by zero. This is also used later to
remove noise from images. Using FX Math...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" image=
            "cameraman_deconvolve_1.png">
  # non-HDRI
  noise=QuantumScale
  convert convolve_kernel.png -roll -64-64 -fft \
          \( cameraman_convolve_1.png -fft \) \
          \
          \( -clone 0,2 -fx "v/(u/p{64,64}+$noise)" \) \
          \( -clone 1,3 -fx 'mod( -u + v + 1.5, 1.0)' \) \
          \
          -delete 0--3 -ift cameraman_deconvolve_1.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_1.png"><img src=
      "cameraman_convolve_1.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_1.png"><img src=
      "cameraman_deconvolve_1.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_1.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_1.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_1.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_1.txt"><img src=
            "roundtrip_cmp_1.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>Using HDRI version of IM to do roundtrip MP convolved FFT
    (FX Math)
    <div align="center">
      <!--
<CODE EXECUTE HDRI SCRIPT IMAGE=cameraman_deconvolve_1hdri.png>
  convert convolve_kernel.png -roll -64-64 -fft \
          \( cameraman_sm.png  -fft \) \
          \
          \( -clone 0,2 -fx 'u*v/ p{64,64} ' \) \
          \( -clone 1,3 -fx 'mod(u + v + 0.5, 1.0)' \) \
          \
          -delete 0-3 -ift  cameraman_convolve_1hdri.png

  #noise=Epsilon
  noise=QuantumScale
  convert convolve_kernel.png -roll -64-64 -fft \
          \( cameraman_convolve_1hdri.png -fft \) \
          \
          \( -clone 0,2 -fx "v/(u/p{64,64}+$noise)" \) \
          \( -clone 1,3 -fx 'mod( -u + v + 1.5, 1.0)' \) \
          \
          -delete 0--3 -ift cameraman_deconvolve_1hdri.png
</CODE>
<CODE EXECUTE SCRIPT ERR2OUT OUT=roundtrip_cmp_1hdri.txt>
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_1hdri.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_1hdri.png null:
</CODE>
-->
      <a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/right.gif" width=
      "20" height="20" align="middle" alt="==&gt;"> <a href=
      "cameraman_convolve_1hdri.png"><img src=
      "cameraman_convolve_1hdri.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/right.gif" width=
      "20" height="20" align="middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_1hdri.png"><img src=
      "cameraman_deconvolve_1hdri.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_1hdri.txt"><img src=
            "roundtrip_cmp_1hdri.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>Using Composite Maths...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" image=
            "cameraman_deconvolve_2.png">
  # non-HDRI
  noise=1
  convert convolve_kernel.png -roll -64-64 -fft \
           \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \
              -clone 0 -compose divide -composite \) -swap 0 +delete \
          \( cameraman_convolve_2.png -fft \) \
          \
          \( -clone  0  -evaluate add $noise \
             -clone  2  -compose divide -composite \) \
          \( -clone 1,3 -compose subtract -background gray50 -flatten \) \
          \
          -delete 0--3 -ift cameraman_deconvolve_2.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_2.png"><img src=
      "cameraman_convolve_2.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_2.png"><img src=
      "cameraman_deconvolve_2.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_2.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_2.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_2.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_2.txt"><img src=
            "roundtrip_cmp_2.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>Using HDRI version of IM to do roundtrip MP convolved FFT
    (Composite Math)
    <div align="center">
      <!--
<CODE EXECUTE HDRI SCRIPT IMAGE=cameraman_deconvolve_2hdri.png>
  convert convolve_kernel.png -roll -64-64 -fft \
          \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \
             -clone 0 -compose divide -composite \) -swap 0 +delete \
          \( cameraman_sm.png -fft \) +matte \
          \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose add -background gray50 -flatten \) \
          \
          -delete 0-3 -ift  cameraman_convolve_2hdri.png

  noise=1
  convert convolve_kernel.png -roll -64-64 -fft \
           \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \
              -clone 0 -compose divide -composite \) -swap 0 +delete \
          \( cameraman_convolve_2hdri.png -fft \) \
          \
          \( -clone  0  -evaluate add $noise \
             -clone  2  -compose divide -composite \) \
          \( -clone 1,3 -compose subtract -background gray50 -flatten \) \
          \
          -delete 0--3 -ift cameraman_deconvolve_2hdri.png

</CODE>
<CODE EXECUTE SCRIPT ERR2OUT OUT=roundtrip_cmp_2hdri.txt>
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_2hdri.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_2hdri.png null:
</CODE>
-->
      <a href="../../img_photos/cameraman_sm.png"><img src=
      "../../img_photos/cameraman_sm.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/right.gif" width=
      "20" height="20" align="middle" alt="==&gt;"> <a href=
      "cameraman_convolve_2hdri.png"><img src=
      "cameraman_convolve_2hdri.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/right.gif" width=
      "20" height="20" align="middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_2hdri.png"><img src=
      "cameraman_deconvolve_2hdri.png" width="128" height="128"
      align="middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_2hdri.txt"><img src=
            "roundtrip_cmp_2hdri.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div><a name="divide_ri" id="divide_ri"></a>
    <h3>FFT divide of Real/Imaginary, Using HDRI version of IM</h3>
    <pre>
    R = B <font size="+2">ø</font> A       ( FFT Divide )

    Denom = Ar×Ar + Ai×Ai + noise
    Rr = ( Ar×Br + Ai×Bi ) / Denom
    Ri = ( Ar×Bi - Ai×Br ) / Denom

    mean = the DC value (center pixel) of the real image
</pre>Using FX...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="" script="" image=
            "cameraman_deconvolve_3.png">
  # HDRI
  #noise=QuantumScale
  noise=Epsilon
  convert convolve_kernel.png -roll -64-64 +fft \
          \( -clone 0 -fx "u/p{64,64}" \) \( -clone 0,1 -fx "v/u.p{64,64}" \) \
          -delete 0,1 \
          \( cameraman_convolve_3.png +fft \) \
          \
          \( -clone 0-3 -fx "u[0]*u[0] + u[1]*u[1] + $noise" \) \
          \( -clone 0-3 -fx 'u[0]*u[2] + u[1]*u[3]' \) \
          \( -clone 0-3 -fx 'u[0]*u[3] - u[1]*u[2]' \) \
          \( -clone 4,5 -fx 'u==0?0:v/u' \) \
          \( -clone 4,6 -fx 'u==0?0:v/u' \) \
          \
          -delete 0--3 +ift cameraman_deconvolve_3.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_3.png"><img src=
      "cameraman_convolve_3.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_3.png"><img src=
      "cameraman_deconvolve_3.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_3.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_3.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_3.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_3.txt"><img src=
            "roundtrip_cmp_3.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>The -fx divide I used above is not nearly as good as a
    composite divide. Presumably due to the extra FX scaling
    involved.
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="" script="" image=
            "cameraman_deconvolve_3b.png">
  # HDRI
  #noise=QuantumScale
  noise=Epsilon
  convert convolve_kernel.png -roll -64-64 +fft \
          \( -clone 0 -fx "u/p{64,64}" \) \( -clone 0,1 -fx "v/u.p{64,64}" \) \
          -delete 0,1 \
          \( cameraman_convolve_3.png +fft \) \
          \
          \( -clone 0-3 -fx "u[0]*u[0] + u[1]*u[1] + $noise" \) \
          \( -clone 0-3 -fx 'u[0]*u[2] + u[1]*u[3]' \) \
          \( -clone 0-3 -fx 'u[0]*u[3] - u[1]*u[2]' \) \
          \( -clone 4,5 -compose divide -composite \) \
          \( -clone 4,6 -compose divide -composite \) \
          \
          -delete 0--3 +ift cameraman_deconvolve_3b.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_3.png"><img src=
      "cameraman_convolve_3.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_3b.png"><img src=
      "cameraman_deconvolve_3b.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_3b.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_3b.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_3b.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_3b.txt"><img src=
            "roundtrip_cmp_3b.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>Using Composite Maths (verbose)...
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="" script="" image=
            "cameraman_deconvolve_4.png">
  # HDRI
  noise=0.00000001  # Epsilon
  convert \( convolve_kernel.png -roll -64-64 +fft \
             \( -clone 0 -crop 1x1+64+64 +repage -scale 128x128 \) \
             \( -clone 2,0 -compose divide -composite \) \
             \( -clone 2,1 -compose divide -composite \) \
             -delete 0-2 \) \
          \( cameraman_convolve_4.png +fft \) \
          \
          \( -clone 0,0 -compose multiply -composite \) \
          \( -clone 1,1 -compose multiply -composite \) \
          \( -clone 0,2 -compose multiply -composite \) \
          \( -clone 1,3 -compose multiply -composite \) \
          \( -clone 0,3 -compose multiply -composite \) \
          \( -clone 1,2 -compose multiply -composite \) \
          \
          \( -clone 4,5 -compose plus  -composite -evaluate add $noise \) \
          \( -clone 6,7 -compose plus -composite \) \
          \( -clone 8,9 +swap -compose minus -composite \) \
          \
          \( -clone 10,11 -compose divide -composite \) \
          \( -clone 10,12 -compose divide -composite \) \
          \
          -delete 0--3 +ift cameraman_deconvolve_4.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_4.png"><img src=
      "cameraman_convolve_4.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_4.png"><img src=
      "cameraman_deconvolve_4.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_4.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_4.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_4.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_4.txt"><img src=
            "roundtrip_cmp_4.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>Optimized Composite Maths... <!--
  This seems to produce a VERY bad response  especially for 'black'
  #noise='#000100010001'
  noise=black
          \( -clone 4,5 -background $noise -compose plus -flatten \) \
  Similarly  for  -evaluate add
-->
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" hdri="" script="" image=
            "cameraman_deconvolve_4b.png">
  # HDRI
  noise=0.00000001  # Epsilon
  convert \( convolve_kernel.png -roll -64-64 +fft \
             \( -clone 0 -gravity center -extent 1x1 -scale 128x128 \) \
             null: +insert +insert -compose divide -layers composite \) \
          \( cameraman_convolve_4.png +fft \) \
          \
          \( -clone 0,1,0,1,0,1 null: -clone 0,1,2,3,3,2 \
                -compose multiply -layers composite \) \
          \( -clone 4,5 -compose plus  -composite -evaluate add $noise \) \
          \( -clone 6,7 -compose plus  -composite \) \
          \( -clone 9,8 -compose minus -composite \) \
          \( -clone 10 null: -clone 11,12 \
                -compose divide -layers composite \) \
          \
          -delete 0--3 +ift cameraman_deconvolve_4b.png
</code></pre>
          </td>
        </tr>
      </table><a href="cameraman_convolve_4.png"><img src=
      "cameraman_convolve_4.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a> <img src="../../img_www/fft_divide.gif"
      width="20" height="30" align="middle"> <a href=
      "convolve_kernel.png"><img src="convolve_kernel.png" width=
      "128" height="128" align="middle" vspace="5" hspace="5"
      border="1" alt="[IM Output]"></a> <img src=
      "../../img_www/right.gif" width="20" height="20" align=
      "middle" alt="==&gt;"> <a href=
      "cameraman_deconvolve_4b.png"><img src=
      "cameraman_deconvolve_4b.png" width="128" height="128" align=
      "middle" vspace="5" hspace="5" border="1" alt=
      "[IM Output]"></a>
    </div>
    <div align="center">
      <table border="1" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <pre><code execute="" script="" err2out="" out=
            "roundtrip_cmp_4b.txt">
  echo -n "Peak = "
  compare -metric PAE cameraman_sm.png cameraman_deconvolve_4b.png null:
  echo -n "Avg = "
  compare -metric RMSE cameraman_sm.png cameraman_deconvolve_4b.png null:
</code></pre>
          </td>
        </tr>
      </table>
      <table border="0" cellspacing="0" cellpadding="5" width="80%"
      bgcolor="#CCCCCC">
        <tr>
          <td>
            <a href="roundtrip_cmp_4b.txt"><img src=
            "roundtrip_cmp_4b.txt.gif" align="middle" vspace="0"
            hspace="0" border="0" alt="[IM Text]"></a>
          </td>
        </tr>
      </table>
    </div>
    <hr>
    <!-- ---------------------------------------------------------------- -->
    <i><b>UPDATE:</b> the use of the color 'gray50' in the above
    should be change to 'gray(50%)' to generate a more accurite 50%
    gray value. The former 'named' color is actually only an 8-bit
    color, and as such not very accurite.<br>
    <br>
    Also with the new colorspace handling, gray50 is in sRGB
    colorspace while gray(50%) is linear colorspace, which is what
    should be used in the above calculations.<br>
    <br>
    The examples also needs to be checked with respect to the use a
    linear gray-scale colorspace.<br>
    <br></i>
  </div>
  <hr>
  <!-- ---------------------------------------------------------------- -->
  <address>
    Created: 13 August 2009<br>
    Updated: 6 October 2009<br>
    Author: <a href="http://www.fmwconcepts.com/fmw/fmw.html">Fred
    Wienhaus</a>, &lt;fmw at alink.net&gt; with editing and
    formatting by <a href=
    "https://antofthy.gitlab.io/anthony.html">Anthony Thyssen</a>,
    &lt;Anthony.Thyssen@gmail.com&gt;<br>
    Examples Generated with: <img src="version.gif" align=
    "absmiddle" alt="[version image]"><br>
    URL:
    <code>https://legacy.imagemagick.org/Usage/fourier/fft_math/</code>
  </address>
</body>
</html>
